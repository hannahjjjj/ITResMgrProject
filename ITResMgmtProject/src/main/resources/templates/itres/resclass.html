<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="/nav"></th:block>
<head>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<meta charset="utf-8">
<link th:href="@{/css/itres/menutree.css}" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

<style>
table th{
	width:200px;
}
</style>
</head>
<body>

<div class="container" style="margin:50px 0 50px 270px; width:1150px;">
	<button type="button" class="btn btn-primary" style="float:right;margin-left: 10px; background-color:navy;">저장</button>
	<button type="button" id="newResClass" class="btn btn-primary" style="float:right; background-color:navy;" >신규</button>
</div>
<div class="container" style="margin-top:70px; display:flex; clear:both;">
    <div class="flex-item" style="width: 1200px;">
        <div class="col-md-12">

            <ul th:each="res:${resClassMap}" class="tree2">[[${res.key}]]
                <li>
            </li>
                <ul>
                    <li th:each="rv:${res.value}">[[${rv.key}]](<span id="resultNumOfRes"></span>)
                        <ul>
                            <li th:each="name:${rv.value}" th:value="${name}"><a href="#" class="resClassDetail">[[${name}]]</a>(<span id="number" th:text="${numOfRes.get('__${name}__')}"/>)</li>
                        </ul>
                    </li>
                </ul>
            </ul>
        </div>
    </div>
			<div class="flex-item" style="width:1200px;">
			
				<div class="row">
					<div class="col-md-16">
						<table id="resClassDetailTable" class="table table-hover">
						 <tbody>
							    <tr>
							      <th scope="row">대 분 류
							      	<td id="topUpperResClassNameCell">
							      	</td>
							      </th>
							    </tr>
							    <tr>
							      <th scope="row">중 분 류
							      	<td id="upperResClassNameCell">
							      	</td>
							      </th>
							    </tr>
							    <tr>
							      <th scope="row">소 분 류
							      	<td id="resClassNameCell">
							      	</td>
							      </th>
							    </tr>
							    <tr>
							      <th scope="row">사용여부
							      	<td id="useYNCell">
							      	</td>
							      </th>
							    </tr>
							    <tr>
							      <th scope="row">분류명
							      	<td id="resClassName2Cell">
							      	</td>
							      </th>
							    </tr>
						    </tbody>
						</table>
						<div>➕부 가 정 보</div>
						<br>
						<div class="addInfoTable">
							<table>
								<thead class="addInfoTableHead">
									<th></th>
									<th>일련번호</th>
									<th>부가항목명</th>
									<th>사용여부</th>
								</thead>
								<tbody>
									<td><input type="checkbox"/></td>
									<td>dd</td>
									<td>dd</td>
									<td>dd</td>
								</tbody>
								
							</table>
						</div>
					</div>
				</div>
			</div>
</div>

<script th:inline="javascript">
$(document).ready(function() {
    // 클래스 "resClassDetail"를 가진 <a> 태그를 클릭할 때 실행되는 함수
    $(".resClassDetail").click(function(event) {
        event.preventDefault(); // 기본 링크 동작 방지
	
        // 클릭한 <a> 태그의 텍스트 (부가항목명) 가져오기
        var resClassName = $(this).text();
        console.log(resClassName)
        // AJAX GET 요청 보내기
        $.ajax({
            type: "GET",
            url: "/resclassdetail", // API 엔드포인트 URL을 여기에 입력하세요
            data: { "resClassName": resClassName },
            success: function(response) {
                // JSON 응답을 JavaScript 객체로 파싱
                // 응답 객체에서 필요한 데이터 추출
                var data = response[0]; // 배열의 첫 번째 항목 사용
                console.log(data)
                // 데이터를 HTML 테이블 셀에 표시
                $("#topUpperResClassNameCell").text(data.topUpperResClassName);
                $("#upperResClassNameCell").text(data.upperResClassName);
                $("#resClassNameCell").text(data.resClassName);
                $("#useYNCell").text(data.useYn);
                $("#resClassName2Cell").text(data.resClassName);
            },
            error: function(error) {
                // 오류 발생 시 실행되는 코드
                console.error("에러 발생: " + error);
            }
        });
    });
});

$(document).ready(function() {
    // "신규" 버튼을 클릭할 때 실행되는 함수
    $("#newResClass").click(function(event) {
  
        // 선택한 <td> 요소
        var topUpperResClassName = $("#topUpperResClassNameCell");
        var upperResClassName = $("#upperResClassNameCell");
        var resClassName = $("#resClassNameCell");
        var resClassName2 = $("#resClassName2Cell");
        
        // 새로운 입력란(input)을 생성하고 <td> 내부에 추가
        var inputElement = $('<input type="text" class="form-control" placeholder="">');
        var inputElement2 = $('<input type="text" class="form-control" placeholder="">');
        var inputElement3 = $('<input type="text" class="form-control" placeholder="">');
        var inputElement4 = $('<input type="text" class="form-control" placeholder="">');
        topUpperResClassName.html(inputElement);
        upperResClassName.html(inputElement2);
        resClassName.html(inputElement3);
        resClassName2.html(inputElement4);
    });
});
</script>
<script type="text/javascript" th:src="@{/js/itres/menutree.js}"></script>
</body>
</html>
